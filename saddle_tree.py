from autograd import jacobian
import autograd.numpy as np
from matplotlib import pyplot as plt
from sympy import Matrix
import seaborn as sns
from tqdm import tqdm
sns.set(style="whitegrid")

####
# Iterations
# 1
# func1 = lambda x: (1-a*(x[0])**2 + eps*(x[0]-x[1]))
# func2 = lambda x: (1-a*(x[1])**2 + eps*(x[1]-x[0]))
# 2
# func1 = lambda x: (1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))
# func2 = lambda x: (1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))
# 3
# func1 = lambda x: (1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))
# func2 = lambda x: (1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))
# 4
# func1 = lambda x: (1-a*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))**2 + eps*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))-(1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))) - x[0]
# func2 = lambda x: (1-a*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))**2 + eps*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))-(1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))) - x[1]
# func3 = lambda x: (1-a*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))**2 + eps*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))-(1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))))
# func4 = lambda x: (1-a*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))**2 + eps*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))-(1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))))
# 8
# func1 = lambda x: (1-a*((1-a*((1-a*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))**2 + eps*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))-(1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))))**2 + eps*((1-a*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))**2 + eps*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))-(1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))))-(1-a*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))**2 + eps*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))-(1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))))))**2 + eps*((1-a*((1-a*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))**2 + eps*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))-(1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))))**2 + eps*((1-a*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))**2 + eps*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))-(1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))))-(1-a*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))**2 + eps*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))-(1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))))))-(1-a*((1-a*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))**2 + eps*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))-(1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))))**2 + eps*((1-a*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))**2 + eps*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))-(1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))))-(1-a*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))**2 + eps*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))-(1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))))))) - x[0]
# func2 = lambda x: (1-a*((1-a*((1-a*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))**2 + eps*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))-(1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))))**2 + eps*((1-a*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))**2 + eps*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))-(1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))))-(1-a*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))**2 + eps*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))-(1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))))))**2 + eps*((1-a*((1-a*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))**2 + eps*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))-(1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))))**2 + eps*((1-a*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))**2 + eps*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))-(1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))))-(1-a*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))**2 + eps*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))-(1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))))))-(1-a*((1-a*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))**2 + eps*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))-(1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))))**2 + eps*((1-a*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))**2 + eps*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))-(1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))))-(1-a*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))**2 + eps*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))-(1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))))))) - x[1]
# func3 = lambda x: (1-a*((1-a*((1-a*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))**2 + eps*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))-(1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))))**2 + eps*((1-a*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))**2 + eps*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))-(1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))))-(1-a*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))**2 + eps*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))-(1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))))))**2 + eps*((1-a*((1-a*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))**2 + eps*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))-(1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))))**2 + eps*((1-a*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))**2 + eps*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))-(1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))))-(1-a*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))**2 + eps*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))-(1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))))))-(1-a*((1-a*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))**2 + eps*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))-(1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))))**2 + eps*((1-a*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))**2 + eps*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))-(1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))))-(1-a*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))**2 + eps*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))-(1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))))))))
# func4 = lambda x: (1-a*((1-a*((1-a*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))**2 + eps*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))-(1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))))**2 + eps*((1-a*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))**2 + eps*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))-(1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))))-(1-a*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))**2 + eps*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))-(1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))))))**2 + eps*((1-a*((1-a*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))**2 + eps*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))-(1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))))**2 + eps*((1-a*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))**2 + eps*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))-(1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))))-(1-a*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))**2 + eps*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))-(1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))))))-(1-a*((1-a*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))**2 + eps*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))-(1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))))**2 + eps*((1-a*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))**2 + eps*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))-(1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))))-(1-a*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))**2 + eps*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))-(1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))))))))
####

Eps = 0.26

# normal bif tree
def normal_tree(m1 = 688, m2 = 176, a1 = 0.3, a2 = 1.16, eps = Eps, size=0.0025):

    xlist1 = []
    wlist1 = []

    for ii in range(m1):
        x = 0.001
        y = 0.02
        for i in range(2000):
            nx = 1 - a1 * x ** 2 + eps * (x - y)
            ny = 1 - a1 * y ** 2 + eps * (y - x)
            x = nx
            y = ny

        for k in range(500):
            nx = 1 - a1 * x ** 2 + eps * (x - y)
            ny = 1 - a1 * y ** 2 + eps * (y - x)
            xlist1.append(nx)
            wlist1.append(a1)
            x = nx
            y = ny
        a1 = a1 + 0.00125

    xlist2 = []
    wlist2 = []

    for ii in range(m2):
        x = 0.001
        y = 0.02
        for i in range(2000):
            nx = 1 - a2 * x ** 2 + eps * (x - y)
            ny = 1 - a2 * y ** 2 + eps * (y - x)
            x = nx
            y = ny

        for k in range(500):
            nx = 1 - a2 * x ** 2 + eps * (x - y)
            ny = 1 - a2 * y ** 2 + eps * (y - x)
            xlist2.append(nx)
            wlist2.append(a2)
            x = nx
            y = ny
        a2 = a2 + 0.00125

    ax.scatter(wlist1, xlist1, s=size, color="black", zorder=10)
    ax.scatter(wlist2, xlist2, s=size, color="black")

# Creating list of points of all types (periodic, saddle, unstable)
def list_of_points(a = np.float64, eps = np.float64, b1 = float, b2 = float, n1 = int, n2 = int):

# b1, b2 - partition boundaries, n1, n2 - number of points, rou - rounding

    func1 = lambda x: (1-a*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))**2 + eps*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))-(1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))) - x[0]
    func2 = lambda x: (1-a*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))**2 + eps*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))-(1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))) - x[1]
    func3 = lambda x: (1-a*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))))**2 + eps*((1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))-(1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))))
    func4 = lambda x: (1-a*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))))**2 + eps*((1-a*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1])))))**2 + eps*((1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))-(1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))))-(1-a*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0])))))**2 + eps*((1-a*((1-a*(x[0])**2 + eps*(x[0]-x[1])))**2 + eps*((1-a*(x[0])**2 + eps*(x[0]-x[1]))-(1-a*(x[1])**2 + eps*(x[1]-x[0]))))-(1-a*((1-a*(x[1])**2 + eps*(x[1]-x[0])))**2 + eps*((1-a*(x[1])**2 + eps*(x[1]-x[0]))-(1-a*(x[0])**2 + eps*(x[0]-x[1]))))))))


    jac_func1 = jacobian(func1)
    jac_func2 = jacobian(func2)
    jac_func3 = jacobian(func3)
    jac_func4 = jacobian(func4)

    spisok = []
    i = 0
    k = 0
    error = 100
    maxiter = 1000
    tol = 0.0001

    N = 2
    M = 2

    xlist = np.linspace(b1, b2, n1)
    ylist = np.linspace(b1, b2, n2)

    for x in tqdm(xlist):
        for y in ylist:
            x_0 = np.array([x,y], dtype = np.float64).reshape(N, 1)
            while np.any(abs(error) > tol) and i < maxiter:

                fun_evaluate = np.array([func1(x_0), func2(x_0)], dtype = np.float64).reshape(M, 1)
                flat_x_0 = x_0.flatten()

                jac = np.array([jac_func1(flat_x_0), jac_func2(flat_x_0)], dtype = np.float64)
                jac = jac.reshape(N, M)

                x_new = x_0 - np.linalg.inv(jac)@fun_evaluate
                error = x_new - x_0

                x_0 = x_new
                i += 1
            ##############
            # discarding points due to specific condition
            if x_0[0] > 1.5 or x_0[0] < -0.7:
                i = 0
                error = 100
                k += 1
                continue
            ###############
            jac = np.array([jac_func3(x_0), jac_func4(x_0)], dtype = np.float64)
            jac = jac.reshape(N, M)
            jac = Matrix(jac)
            eigs = jac.eigenvals()

            if (abs(list(eigs)[0]) > 1 > abs(list(eigs)[1])) or (abs(list(eigs)[1]) > 1 > abs(list(eigs)[0])) or (abs(list(eigs)[1]) > 1 and abs(list(eigs)[0]) > 1):
                x_0 = x_0.tolist()
                x_0 = tuple(sum(x_0, []))
                spisok.append(x_0)

            i = 0
            error = 100
            k += 1

    return list(set(spisok))

# drawing lines
def draw_curves(tup, b1=float, b2=float, n=int, eps = Eps, size = 0.0085):       #tup-tuple, b1,b2- parameter limits, n - step of parameter

    func1 = lambda x: (1 - a * ((1 - a * ((1 - a * ((1 - a * (x[0]) ** 2 + eps * (x[0] - x[1]))) ** 2 + eps * (
                (1 - a * (x[0]) ** 2 + eps * (x[0] - x[1])) - (
                    1 - a * (x[1]) ** 2 + eps * (x[1] - x[0]))))) ** 2 + eps * ((1 - a * (
    (1 - a * (x[0]) ** 2 + eps * (x[0] - x[1]))) ** 2 + eps * ((1 - a * (x[0]) ** 2 + eps * (x[0] - x[1])) - (
                1 - a * (x[1]) ** 2 + eps * (x[1] - x[0])))) - (1 - a * (
    (1 - a * (x[1]) ** 2 + eps * (x[1] - x[0]))) ** 2 + eps * ((1 - a * (x[1]) ** 2 + eps * (x[1] - x[0])) - (
                1 - a * (x[0]) ** 2 + eps * (x[0] - x[1]))))))) ** 2 + eps * ((1 - a * ((
                1 - a * ((1 - a * (x[0]) ** 2 + eps * (x[0] - x[1]))) ** 2 + eps * (
                    (1 - a * (x[0]) ** 2 + eps * (x[0] - x[1])) - (
                        1 - a * (x[1]) ** 2 + eps * (x[1] - x[0]))))) ** 2 + eps * ((1 - a * (
    (1 - a * (x[0]) ** 2 + eps * (x[0] - x[1]))) ** 2 + eps * ((1 - a * (x[0]) ** 2 + eps * (x[0] - x[1])) - (
                1 - a * (x[1]) ** 2 + eps * (x[1] - x[0])))) - (1 - a * (
    (1 - a * (x[1]) ** 2 + eps * (x[1] - x[0]))) ** 2 + eps * ((1 - a * (x[1]) ** 2 + eps * (x[1] - x[0])) - (
                1 - a * (x[0]) ** 2 + eps * (x[0] - x[1])))))) - (1 - a * ((
                1 - a * ((1 - a * (x[1]) ** 2 + eps * (x[1] - x[0]))) ** 2 + eps * (
                    (1 - a * (x[1]) ** 2 + eps * (x[1] - x[0])) - (
                        1 - a * (x[0]) ** 2 + eps * (x[0] - x[1]))))) ** 2 + eps * ((1 - a * (
    (1 - a * (x[1]) ** 2 + eps * (x[1] - x[0]))) ** 2 + eps * ((1 - a * (x[1]) ** 2 + eps * (x[1] - x[0])) - (
                1 - a * (x[0]) ** 2 + eps * (x[0] - x[1])))) - (1 - a * (
    (1 - a * (x[0]) ** 2 + eps * (x[0] - x[1]))) ** 2 + eps * ((1 - a * (x[0]) ** 2 + eps * (x[0] - x[1])) - (
                1 - a * (x[1]) ** 2 + eps * (x[1] - x[0])))))))) - x[0]
    func2 = lambda x: (1 - a * ((1 - a * ((1 - a * ((1 - a * (x[1]) ** 2 + eps * (x[1] - x[0]))) ** 2 + eps * (
                (1 - a * (x[1]) ** 2 + eps * (x[1] - x[0])) - (
                    1 - a * (x[0]) ** 2 + eps * (x[0] - x[1]))))) ** 2 + eps * ((1 - a * (
    (1 - a * (x[1]) ** 2 + eps * (x[1] - x[0]))) ** 2 + eps * ((1 - a * (x[1]) ** 2 + eps * (x[1] - x[0])) - (
                1 - a * (x[0]) ** 2 + eps * (x[0] - x[1])))) - (1 - a * (
    (1 - a * (x[0]) ** 2 + eps * (x[0] - x[1]))) ** 2 + eps * ((1 - a * (x[0]) ** 2 + eps * (x[0] - x[1])) - (
                1 - a * (x[1]) ** 2 + eps * (x[1] - x[0]))))))) ** 2 + eps * ((1 - a * ((
                1 - a * ((1 - a * (x[1]) ** 2 + eps * (x[1] - x[0]))) ** 2 + eps * (
                    (1 - a * (x[1]) ** 2 + eps * (x[1] - x[0])) - (
                        1 - a * (x[0]) ** 2 + eps * (x[0] - x[1]))))) ** 2 + eps * ((1 - a * (
    (1 - a * (x[1]) ** 2 + eps * (x[1] - x[0]))) ** 2 + eps * ((1 - a * (x[1]) ** 2 + eps * (x[1] - x[0])) - (
                1 - a * (x[0]) ** 2 + eps * (x[0] - x[1])))) - (1 - a * (
    (1 - a * (x[0]) ** 2 + eps * (x[0] - x[1]))) ** 2 + eps * ((1 - a * (x[0]) ** 2 + eps * (x[0] - x[1])) - (
                1 - a * (x[1]) ** 2 + eps * (x[1] - x[0])))))) - (1 - a * ((
                1 - a * ((1 - a * (x[0]) ** 2 + eps * (x[0] - x[1]))) ** 2 + eps * (
                    (1 - a * (x[0]) ** 2 + eps * (x[0] - x[1])) - (
                        1 - a * (x[1]) ** 2 + eps * (x[1] - x[0]))))) ** 2 + eps * ((1 - a * (
    (1 - a * (x[0]) ** 2 + eps * (x[0] - x[1]))) ** 2 + eps * ((1 - a * (x[0]) ** 2 + eps * (x[0] - x[1])) - (
                1 - a * (x[1]) ** 2 + eps * (x[1] - x[0])))) - (1 - a * (
    (1 - a * (x[1]) ** 2 + eps * (x[1] - x[0]))) ** 2 + eps * ((1 - a * (x[1]) ** 2 + eps * (x[1] - x[0])) - (
                1 - a * (x[0]) ** 2 + eps * (x[0] - x[1])))))))) - x[1]
    func3 = lambda x: (1 - a * ((1 - a * ((1 - a * ((1 - a * (x[0]) ** 2 + eps * (x[0] - x[1]))) ** 2 + eps * (
                (1 - a * (x[0]) ** 2 + eps * (x[0] - x[1])) - (
                    1 - a * (x[1]) ** 2 + eps * (x[1] - x[0]))))) ** 2 + eps * ((1 - a * (
    (1 - a * (x[0]) ** 2 + eps * (x[0] - x[1]))) ** 2 + eps * ((1 - a * (x[0]) ** 2 + eps * (x[0] - x[1])) - (
                1 - a * (x[1]) ** 2 + eps * (x[1] - x[0])))) - (1 - a * (
    (1 - a * (x[1]) ** 2 + eps * (x[1] - x[0]))) ** 2 + eps * ((1 - a * (x[1]) ** 2 + eps * (x[1] - x[0])) - (
                1 - a * (x[0]) ** 2 + eps * (x[0] - x[1]))))))) ** 2 + eps * ((1 - a * ((
                1 - a * ((1 - a * (x[0]) ** 2 + eps * (x[0] - x[1]))) ** 2 + eps * (
                    (1 - a * (x[0]) ** 2 + eps * (x[0] - x[1])) - (
                        1 - a * (x[1]) ** 2 + eps * (x[1] - x[0]))))) ** 2 + eps * ((1 - a * (
    (1 - a * (x[0]) ** 2 + eps * (x[0] - x[1]))) ** 2 + eps * ((1 - a * (x[0]) ** 2 + eps * (x[0] - x[1])) - (
                1 - a * (x[1]) ** 2 + eps * (x[1] - x[0])))) - (1 - a * (
    (1 - a * (x[1]) ** 2 + eps * (x[1] - x[0]))) ** 2 + eps * ((1 - a * (x[1]) ** 2 + eps * (x[1] - x[0])) - (
                1 - a * (x[0]) ** 2 + eps * (x[0] - x[1])))))) - (1 - a * ((
                1 - a * ((1 - a * (x[1]) ** 2 + eps * (x[1] - x[0]))) ** 2 + eps * (
                    (1 - a * (x[1]) ** 2 + eps * (x[1] - x[0])) - (
                        1 - a * (x[0]) ** 2 + eps * (x[0] - x[1]))))) ** 2 + eps * ((1 - a * (
    (1 - a * (x[1]) ** 2 + eps * (x[1] - x[0]))) ** 2 + eps * ((1 - a * (x[1]) ** 2 + eps * (x[1] - x[0])) - (
                1 - a * (x[0]) ** 2 + eps * (x[0] - x[1])))) - (1 - a * (
    (1 - a * (x[0]) ** 2 + eps * (x[0] - x[1]))) ** 2 + eps * ((1 - a * (x[0]) ** 2 + eps * (x[0] - x[1])) - (
                1 - a * (x[1]) ** 2 + eps * (x[1] - x[0]))))))))
    func4 = lambda x: (1 - a * ((1 - a * ((1 - a * ((1 - a * (x[1]) ** 2 + eps * (x[1] - x[0]))) ** 2 + eps * (
                (1 - a * (x[1]) ** 2 + eps * (x[1] - x[0])) - (
                    1 - a * (x[0]) ** 2 + eps * (x[0] - x[1]))))) ** 2 + eps * ((1 - a * (
    (1 - a * (x[1]) ** 2 + eps * (x[1] - x[0]))) ** 2 + eps * ((1 - a * (x[1]) ** 2 + eps * (x[1] - x[0])) - (
                1 - a * (x[0]) ** 2 + eps * (x[0] - x[1])))) - (1 - a * (
    (1 - a * (x[0]) ** 2 + eps * (x[0] - x[1]))) ** 2 + eps * ((1 - a * (x[0]) ** 2 + eps * (x[0] - x[1])) - (
                1 - a * (x[1]) ** 2 + eps * (x[1] - x[0]))))))) ** 2 + eps * ((1 - a * ((
                1 - a * ((1 - a * (x[1]) ** 2 + eps * (x[1] - x[0]))) ** 2 + eps * (
                    (1 - a * (x[1]) ** 2 + eps * (x[1] - x[0])) - (
                        1 - a * (x[0]) ** 2 + eps * (x[0] - x[1]))))) ** 2 + eps * ((1 - a * (
    (1 - a * (x[1]) ** 2 + eps * (x[1] - x[0]))) ** 2 + eps * ((1 - a * (x[1]) ** 2 + eps * (x[1] - x[0])) - (
                1 - a * (x[0]) ** 2 + eps * (x[0] - x[1])))) - (1 - a * (
    (1 - a * (x[0]) ** 2 + eps * (x[0] - x[1]))) ** 2 + eps * ((1 - a * (x[0]) ** 2 + eps * (x[0] - x[1])) - (
                1 - a * (x[1]) ** 2 + eps * (x[1] - x[0])))))) - (1 - a * ((
                1 - a * ((1 - a * (x[0]) ** 2 + eps * (x[0] - x[1]))) ** 2 + eps * (
                    (1 - a * (x[0]) ** 2 + eps * (x[0] - x[1])) - (
                        1 - a * (x[1]) ** 2 + eps * (x[1] - x[0]))))) ** 2 + eps * ((1 - a * (
    (1 - a * (x[0]) ** 2 + eps * (x[0] - x[1]))) ** 2 + eps * ((1 - a * (x[0]) ** 2 + eps * (x[0] - x[1])) - (
                1 - a * (x[1]) ** 2 + eps * (x[1] - x[0])))) - (1 - a * (
    (1 - a * (x[1]) ** 2 + eps * (x[1] - x[0]))) ** 2 + eps * ((1 - a * (x[1]) ** 2 + eps * (x[1] - x[0])) - (
                1 - a * (x[0]) ** 2 + eps * (x[0] - x[1]))))))))

    i = 0
    error = 100
    maxiter = 1000
    tol = 0.0001

    N = 2
    M = 2

    a_vec_unstable = []
    a_vec_saddle = []
    x_vec_saddle = []
    x_vec_unstable = []

    jac_func1 = jacobian(func1)
    jac_func2 = jacobian(func2)
    jac_func3 = jacobian(func3)
    jac_func4 = jacobian(func4)

    x, y = tup

    aList = np.linspace(b1, b2, n)
    x_0 = np.array([x, y], dtype=np.float64).reshape(N, 1)

    for a in aList:

        while np.any(abs(error) > tol) and i < maxiter:
            fun_evaluate = np.array([func1(x_0), func2(x_0)], dtype=np.float64).reshape(M, 1)
            flat_x_0 = x_0.flatten()

            jac = np.array([jac_func1(flat_x_0), jac_func2(flat_x_0)], dtype=np.float64)
            jac = jac.reshape(N, M)

            x_new = x_0 - np.linalg.inv(jac) @ fun_evaluate
            error = x_new - x_0

            x_0 = x_new
            i += 1

        jac = np.array([jac_func3(x_0), jac_func4(x_0)], dtype=np.float64)
        jac = jac.reshape(N, M)
        jac = Matrix(jac)
        eigs = jac.eigenvals()

        if (abs(list(eigs)[0]) > 1 > abs(list(eigs)[1])) or (abs(list(eigs)[1]) > 1 > abs(list(eigs)[0])):
            x_save = x_0.tolist()
            x_save = tuple(sum(x_save, []))
            a_vec_saddle.append(a)
            x_vec_saddle.append(x_save[0])
        if abs(list(eigs)[1]) > 1 and abs(list(eigs)[0]) > 1:
            x_save = x_0.tolist()
            x_save = tuple(sum(x_save, []))
            a_vec_unstable.append(a)
            x_vec_unstable.append(x_save[0])
        i = 0
        error = 100
    ax.scatter(a_vec_saddle, x_vec_saddle, s=size, color="green", zorder=5)
    ax.scatter(a_vec_unstable, x_vec_unstable, s=size, color="red", zorder=5)

####
# Final figure

fig, ax = plt.subplots()
plt.xlabel('a')
plt.ylabel('x')
plt.xlim(0.7, 1.33)
plt.ylim(-8, 6)
fig.set_figheight(8)
fig.set_figwidth(10)

####
# vary parameter

a_1 = 1.27

# Finding needed points and saving them in list_of_tups (to do the procedure only once)

list_of_tups = list_of_points(a=a_1, eps=Eps, b1=-0.7, b2=1.5, n1=40, n2=40)

# drawing lines

for tup in tqdm(list_of_tups):
    try:
        draw_curves(tup=tup, b1=1.27, b2=0.6, n=350)
    except Exception as err:
        print(tup)
        print(type(err))
    try:
        draw_curves(tup=tup, b1=1.27, b2=1.4, n=50)
    except Exception as err:
        print(tup)
        print(type(err))

normal_tree()

plt.show()